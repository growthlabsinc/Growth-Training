# Story 13.3: Update Method Overview & Detail UI for New Content

**Status:** Draft

## Goal & Context

**User Story:** As a User, I want the "Methods" overview and detail screens to clearly display the updated and reclassified Growth Methods, including their new descriptions, techniques, and progression criteria.

**Context:** This story builds upon the reclassification of Growth Methods (Story 13.1) and the Angio Pumping implementation (Story 13.2). Now that the methods have been updated in Firestore with new classifications, descriptions, techniques, and progression criteria, the UI needs to be updated to display this new information effectively to users. The Methods Overview screen needs to group methods by their new classification system (Beginner, Foundation, etc.) and the Method Detail screen needs to show all the detailed information for each method.

## Detailed Requirements

- Modify the "Methods Overview Screen" (Epic 3, Story 3.1) to display methods under the new classification headers (Beginner, Foundation, Intermediate, Expert, Master).
- Ensure the "Method Detail Screen" (Epic 3, Story 3.2) correctly fetches and displays all updated content for each reclassified method from Firestore, including:
  - Detailed technique steps.
  - Progression criteria.
  - Required tools.
  - Specific safety warnings from `docs/Untitled 5.txt` (e.g., AM 2.0: "AVOID ABUSING YOUR PELVIC FLOOR MUSCLES"[cite: 249]; Vascion: "common for your Corpora Spongiosum to go flat" [cite: 277]).
- The UI must clearly present this potentially complex information in an easy-to-digest format.

## Acceptance Criteria (ACs)

- AC1: Methods Overview screen correctly lists methods under the new classifications.
- AC2: Method Detail screens display all updated content (description, technique, progression, tools, safety notes) accurately from Firestore for each method.
- AC3: The UI effectively presents the detailed information from `docs/Untitled 5.txt` and `docs/Untitled 6.txt`.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. The developer should understand how to modify the existing Methods screens to accommodate the new content organization and display.

- **Relevant Files:**

  - Files to Modify: 
    - `Growth/Features/GrowthMethods/Views/GrowthMethodsListView.swift` - Update to display methods by classification
    - `Growth/Features/GrowthMethods/Views/GrowthMethodDetailView.swift` - Update to display all new content fields
    - `Growth/Features/GrowthMethods/ViewModels/GrowthMethodsViewModel.swift` - Update to organize methods by classification
    - `Growth/Features/GrowthMethods/ViewModels/GrowthMethodDetailViewModel.swift` - Update to support new fields
    - `Growth/Core/Services/GrowthMethodService.swift` - Ensure the service is fetching all new fields correctly

- **Key Technologies:**

  - SwiftUI for UI components
  - Combine framework for view model state management
  - Firebase Firestore for data retrieval

- **API Interactions / SDK Usage:**

  - Firestore operations:
    - Read from the `growthMethods` collection with updated field structure
    - Ensure correct collection name is used (`growthMethods` vs. `growth_methods`)

- **Data Structures:**

  - The `GrowthMethod` model in Core/Models already has `classification` field added in Story 13.1
  - Structure for organizing methods by classification:
    ```swift
    // Example structure for grouped methods
    [String: [GrowthMethod]] // Dictionary with classification as key, array of methods as value
    ```

- **UI/UX Notes:**
  - Group methods by classification in the list view
  - For each classification group, show a header with the classification name
  - Methods within each group should be sorted by stage
  - The detail view should use expandable sections to organize the detailed content
  - Safety notes should be prominently displayed with appropriate styling to draw attention

- **Coding Standards Notes:**
  - Follow existing UI patterns for consistency
  - Use SwiftUI's new layout capabilities where appropriate for better organization
  - Ensure accessibility is maintained with proper labels and semantic descriptions

## Tasks / Subtasks

- [ ] Update GrowthMethodsViewModel
  - [ ] Add functionality to group methods by classification
  - [ ] Ensure methods are properly sorted within each classification
  - [ ] Add appropriate filtering capability that respects classifications
  - [ ] Verify the correct Firestore collection name is being used (`growthMethods`)

- [ ] Update GrowthMethodsListView
  - [ ] Modify UI to display methods grouped by classification
  - [ ] Add classification headers with appropriate styling
  - [ ] Update method cards to show classification and stage
  - [ ] Ensure filtering works correctly with the new layout

- [ ] Update GrowthMethodDetailViewModel
  - [ ] Ensure all new fields are properly loaded and exposed
  - [ ] Add any new helper properties needed for the UI

- [ ] Update GrowthMethodDetailView
  - [ ] Redesign to display all new content fields
  - [ ] Add sections for progression criteria and safety notes
  - [ ] Improve organization of potentially lengthy content
  - [ ] Ensure proper styling for safety warnings and important notes

- [ ] Test with all method types
  - [ ] Verify each classification is displayed correctly
  - [ ] Test that filtering works as expected
  - [ ] Check that all detail screens show the proper information

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests.

- **Unit Tests:** 
  - Test GrowthMethodsViewModel's grouping and sorting functionality
  - Verify that methods are correctly filtered when using search or category filters

- **Integration Tests:** 
  - Test the full flow from list view to detail view
  - Verify that all method information is correctly displayed

- **Manual Verification:**
  - Verify the list view correctly groups methods by classification
  - Check each method detail view to ensure all fields are displayed correctly
  - Verify that safety notes are prominently displayed
  - Test filtering and searching functionality with the new organization
  - Verify the app handles methods with missing fields gracefully
  - Test on different device sizes to ensure responsive layout

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** `<Agent Model Name/Version>`
- **Completion Notes:** {Any notes about implementation choices, difficulties, or follow-up needed}
- **Change Log:** {Track changes _within this specific story file_ if iterations occur}
  - Initial Draft
  - ... 