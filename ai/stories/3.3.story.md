# Story 3.3: Growth Methods Data Seeding – Robustness, Validation, and Developer Experience

**Status:** Draft

## Goal & Context

**User Story:** As a Developer/Admin, I need a robust, well-documented, and developer-friendly script to seed and update Growth Method content in Firestore, with strong validation and clear feedback, so that instructional data is always accurate, complete, and easy to maintain.

**Context:**
This story ensures the `growthMethods` collection in Firestore is always populated with up-to-date, validated, and well-structured data matching the `GrowthMethod` model. The seeding process must be safe to re-run, provide actionable feedback, and be easy for future developers to extend or troubleshoot. This is foundational for all user-facing method screens and future content updates.

## Detailed Requirements

- Maintain and improve the script (`scripts/seed-firestore-data.js`) that seeds/updates the `growthMethods` collection in Firestore.
- Script must:
  - Read from a sample data file (`data/sample-methods.json`).
  - Map all fields to match the `GrowthMethod` model:
    - `methodId` → Firestore doc ID and `id`
    - `description` → `methodDescription`
    - `instructions_text` → `instructionsText`
    - `visual_placeholder_url` → `visualPlaceholderUrl`
    - `equipment_needed` → `equipmentNeeded`
    - `estimatedTimeMinutes` (optional, default 0)
    - `categories` (optional, default [])
    - `isFeatured` (optional, default false)
    - `safety_notes` → `safetyNotes` (optional)
  - Add `createdAt`, `updatedAt`, and `published` fields.
  - Ignore extra fields not in the model.
  - Validate all required fields for each method before upload. Log and skip any invalid entries, with clear error messages.
  - Be idempotent: update existing docs, create new ones, never duplicate.
  - Log created/updated/skipped actions with method IDs and reasons.
  - Exit with a nonzero code if any errors or invalid data are encountered.
- Sample data file must:
  - Include at least 3 methods, covering all required fields and some optional fields.
  - Be easy to edit for future updates.
- Document the seeding process, field mapping, validation rules, and how to add new methods in `README.md` or `docs/content-seeding.md`.
- No UI changes required for this story.

## Acceptance Criteria (ACs)

- AC1: The seeding script validates, maps, and uploads all required/optional fields for each method to Firestore.
- AC2: Script is idempotent and logs created/updated/skipped actions with reasons.
- AC3: Script logs and skips invalid entries, exiting with error if any are found.
- AC4: Sample data file is present, valid, and covers all field types.
- AC5: Seeding process, field mapping, and validation rules are documented for future maintainers.
- AC6: Data in Firestore matches the `GrowthMethod` model and is ready for app consumption.

## Technical Implementation Context

**Guidance:**
- **Relevant Files:**
  - `scripts/seed-firestore-data.js`
  - `data/sample-methods.json`
  - `Growth/Core/Models/GrowthMethod.swift`
  - `README.md` or `docs/content-seeding.md`
- **Key Technologies:**
  - Node.js (with Firebase Admin SDK)
  - Firestore
- **Best Practices:**
  - Use environment variables for credentials
  - Validate data before upload (required fields, types, value ranges)
  - Log all actions and errors with context
  - Keep sample data and model in sync
  - Make it easy for future devs to add/modify methods

## Tasks / Subtasks

- [ ] Review and update sample data file for completeness and validation coverage
- [ ] Ensure script field mapping and validation match model
- [ ] Test idempotency, error handling, and logging
- [ ] Document process, mapping, and validation rules

## Testing Requirements

- **Unit/Integration Tests:**
  - Test that all valid methods are created/updated as expected
  - Test script idempotency
  - Test with missing/invalid data (error handling, logging, exit code)
- **Manual/CLI Verification:**
  - Run script and verify data in Firestore
  - Edit sample data and re-run to confirm updates and error handling

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** <Agent Model Name/Version>
- **Completion Notes:**
- **Change Log:**
  - Redrafted for robust validation, developer experience, and future maintainability 