# Story 20.2: Tour Step 1 - The "Today View" Dashboard

**Status:** Review

## Goal & Context

**User Story:** As a New User on the app tour, I want to understand the purpose of the Home (Dashboard) screen, so I know where to look for my daily tasks and progress snapshot.

**Context:** This story builds upon the app tour framework established in Story 20.1 by implementing the first actual tour step. The tour will highlight key components of the Dashboard screen, helping new users understand where to find their daily tasks and progress information. This is the first of five tour steps that will guide users through the app's main features.

## Detailed Requirements

- Create the first step of the tour, highlighting the main components of the "Today View" Dashboard (from Epic 15, Story 15.2).
- A popover or coach mark should explain: "This is your Home screen, your starting point for each day. Your 'Today's Focus' shows you exactly what to do."
- A second highlight in this step could point to the "Weekly Progress Snapshot" with the text: "Quickly check your weekly progress and streak right here."

## Acceptance Criteria (ACs)

- AC1: The tour correctly highlights the "Today's Focus" area on the Dashboard.
- AC2: The popover text clearly and concisely explains the purpose of the Home screen and its main sections.
- AC3: Tapping "Next" proceeds to the next step of the tour.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. Developer agent is expected to follow project standards in `docs/coding-standards.md` and understand the project structure in `docs/project-structure.md`. Only story-specific details are included below.

- **Relevant Files:**

  - Files to Create: 
    - None (tour steps configuration will be added to existing framework)
  
  - Files to Modify: 
    - `Growth/Features/AppTour/Models/AppTourStep.swift` - Update defaultTour configuration
    - `Growth/Features/Dashboard/Views/DashboardView.swift` - Add tour target IDs
    - `Growth/Features/Dashboard/Components/TodaysFocusView.swift` - Add tour target ID
    - `Growth/Features/Dashboard/Components/WeeklyProgressSnapshotView.swift` - Add tour target ID
    - `GrowthUITests/AppTourUITests.swift` - Add tests for dashboard tour step

- **Key Technologies:**

  - SwiftUI's `.tourTarget()` modifier from Story 20.1
  - AppTourStep configuration model
  - Coach mark UI components already created

- **API Interactions / SDK Usage:**

  - No new API interactions required
  - Uses existing AppTourService for state persistence

- **UI/UX Notes:**

  - Dashboard highlights should use appropriate padding (20-30 points)
  - Popovers should position themselves to avoid obscuring the highlighted content
  - Consider using `.below` position for title areas and `.above` for bottom elements
  - Ensure proper contrast between coach mark text and background overlay

- **Data Structures:**

  - Update the `AppTourStep` instances in `defaultTour`:
    ```swift
    AppTourStep(
        id: "dashboard_overview",
        targetViewId: "dashboard_title",
        title: "Welcome to Your Dashboard",
        description: "This is your Home screen, your starting point for each day. Your 'Today's Focus' shows you exactly what to do.",
        highlightPadding: 20,
        position: .below
    ),
    AppTourStep(
        id: "weekly_progress",
        targetViewId: "weekly_progress_snapshot",
        title: "Track Your Progress",
        description: "Quickly check your weekly progress and streak right here.",
        highlightPadding: 20,
        position: .above
    )
    ```

- **Environment Variables:**

  - None required for this story

- **Coding Standards Notes:**
  - Follow existing tour step naming conventions (lowercase with underscores for IDs)
  - Ensure all UI text is prepared for future localization
  - Keep tour descriptions concise and action-oriented

## Tasks / Subtasks

- [x] Update AppTourStep.swift with dashboard tour steps
  - [x] Add "dashboard_overview" step highlighting the main dashboard area
  - [x] Add "weekly_progress" step highlighting the progress snapshot
  - [x] Ensure steps are in correct order with proper navigation
- [x] Add tour target IDs to Dashboard components
  - [x] Add `.tourTarget(id: "dashboard_title")` to main dashboard title
  - [x] Add `.tourTarget(id: "todays_focus")` to TodaysFocusView
  - [x] Add `.tourTarget(id: "weekly_progress_snapshot")` to WeeklyProgressSnapshotView
- [x] Test tour step functionality
  - [x] Verify highlights appear in correct locations
  - [x] Ensure popover text is readable and positioned correctly
  - [x] Test navigation to next step (placeholder for Story 20.3)
- [x] Update UI tests for dashboard tour step
  - [x] Add test to verify dashboard highlights appear
  - [x] Test tour text content matches requirements
  - [x] Verify navigation flow

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests. Follow general testing approach in `docs/testing-strategy.md`.

- **Unit Tests:** 
  - Verify tour configuration includes dashboard steps with correct properties
  - Test that dashboard tour steps have unique IDs
  - Ensure step order is maintained

- **UI Tests:** 
  - Test that dashboard elements are highlighted when tour is active
  - Verify popover appears with correct text for each dashboard highlight
  - Test that tapping "Next" advances to the next tour step
  - Verify tour works on different screen sizes (iPhone SE, iPhone 15, iPad)

- **Manual Verification:** 
  - Launch app as new user and complete onboarding
  - Verify tour starts automatically on dashboard
  - Check that dashboard elements are properly highlighted
  - Ensure popovers don't obscure important content
  - Test on both light and dark mode

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** `Claude Opus 4 (claude-opus-4-20250514)`
- **Completion Notes:** 
  - Successfully implemented dashboard tour steps with two highlights: dashboard overview and weekly progress
  - Added tour target modifiers to appropriate dashboard components (dashboard title already had it, added to TodaysFocusView and WeeklyProgressSnapshotView)
  - Updated AppTourStep configuration to include proper button text ("Get Started") for the last step
  - Created comprehensive unit tests for tour configuration and added UI tests for dashboard tour navigation
  - The tour framework from Story 20.1 was properly extended to support the dashboard tour content
- **Change Log:** 
  - Initial Draft - Created story following Epic 20 requirements
  - Implementation - Added dashboard tour steps, tour targets, and tests