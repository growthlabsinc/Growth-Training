# Story 15.2: Develop "Today View" Dashboard as Primary Hub

**Status:** Completed

## Goal & Context

**User Story:** As a User, I want my Dashboard ("Home") to primarily show me what I need to focus on today, whether it's a routine activity, a quick practice option, or rest day information.

**Context:** This story builds upon the revised Information Architecture implemented in Story 15.1 by redesigning the Home screen to be the central "Today View" dashboard. The current DashboardView has multiple sections and cards, but lacks the focused, context-aware "Today's Focus" approach outlined in the UI/UX Integration Plan. This redesign will make the dashboard the primary entry point for users' daily practice decisions, dynamically adapting to their routine status and progress.

## Detailed Requirements

- Redesign the Home screen to be the "Today View" dashboard.
- Implement the "Today's Focus" section dynamically displaying:
  - **Routine Day Overview:** If the user is following a routine and it's a practice day (method(s), intensity, duration).
  - **Quick Practice Option:** If no routine is active, or the routine day is completed, offer quick practice suggestions.
  - **Rest Day Activities:** If it's a designated rest day in the routine.
- Implement the "Weekly Progress Snapshot" section showing:
  - Routine Adherence (placeholder for logic from Epic 17).
  - Total Practice Time this week.
  - Current Streak Status.
- Implement "Quick Actions Based on Context" (e.g., "Start Today's Routine," "Log Quick Practice").

## Acceptance Criteria (ACs)

- AC1: The Home screen is redesigned as the "Today View" dashboard.
- AC2: The "Today's Focus" section dynamically shows routine day overview, quick practice options, or rest day activities based on user context.
- AC3: The "Weekly Progress Snapshot" displays streak, total practice time, and a placeholder for routine adherence.
- AC4: Contextual quick action buttons are available on the dashboard.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. Developer agent is expected to follow project standards in `docs/coding-standards.md` and understand the project structure in `docs/project-structure.md`. Only story-specific details are included below.

- **Relevant Files:**

  - Files to Modify: 
    - `/Users/tradeflowj/Desktop/Growth/Growth/Features/Dashboard/Views/DashboardView.swift` (complete redesign as "Today View")
    
  - Files to Create:
    - `/Users/tradeflowj/Desktop/Growth/Growth/Features/Dashboard/Components/TodaysFocusView.swift`
    - `/Users/tradeflowj/Desktop/Growth/Growth/Features/Dashboard/Components/WeeklyProgressSnapshotView.swift`
    - `/Users/tradeflowj/Desktop/Growth/Growth/Features/Dashboard/Components/ContextualQuickActionsView.swift`
    - `/Users/tradeflowj/Desktop/Growth/Growth/Features/Dashboard/ViewModels/TodayViewViewModel.swift`

- **Key Technologies:**

  - SwiftUI for UI implementation
  - Combine for reactive data flow and state management
  - Firebase Auth for user authentication context
  - FirebaseFirestore for routine and progress data retrieval
  - Existing StreakTracker for streak status
  - Existing ProgressViewModel for weekly progress data

- **API Interactions / SDK Usage:**

  - Use existing FirestoreService for routine and session data retrieval
  - Use existing StreakTracker.shared for current streak information
  - Use existing ProgressViewModel for weekly practice time calculations
  - Integrate with existing RoutinesViewModel for active routine status

- **UI/UX Notes:**

  - Maintain consistent visual design with AppTheme and AppColors
  - Use established card-based layout pattern with RoundedCard component
  - Implement dynamic content based on user's routine status and daily schedule
  - Primary focus should be on the "Today's Focus" section as the hero element
  - Weekly Progress Snapshot should be secondary but prominent
  - Quick Actions should be contextually relevant (different actions based on routine status)
  - Maintain accessibility support with proper labels and VoiceOver compatibility

- **Data Structures:**

  - Use existing DaySchedule model for routine day information
  - Use existing RoutineModel for current routine data
  - Use existing SessionLog model for progress calculations
  - Create TodayFocusState enum: .routineDay(DaySchedule), .quickPractice, .restDay(String), .completed
  - Use existing ProgressViewModel for weekly metrics

- **Environment Variables:**

  - No new environment variables needed for this story
  - Use existing Firebase configuration

- **Coding Standards Notes:**
  - Follow SwiftUI best practices for view composition and state management
  - Extract complex views into separate components for maintainability
  - Use @StateObject and @ObservedObject appropriately for view model integration
  - Implement proper error handling and loading states
  - Follow established naming conventions and file organization patterns

## Tasks / Subtasks

- [ ] Create TodayViewViewModel to manage dashboard state and data
  - [ ] Implement logic to determine today's focus state (routine day, quick practice, rest day, completed)
  - [ ] Integrate with existing RoutinesViewModel and ProgressViewModel
  - [ ] Add methods for weekly progress snapshot data retrieval
- [ ] Create TodaysFocusView component
  - [ ] Implement dynamic content based on TodayFocusState
  - [ ] Design routine day overview layout with method details
  - [ ] Design quick practice option presentation
  - [ ] Design rest day activities presentation
  - [ ] Add hero image and visual hierarchy
- [ ] Create WeeklyProgressSnapshotView component
  - [ ] Display current streak status with existing StreakTracker integration
  - [ ] Show total practice time for current week
  - [ ] Add placeholder for routine adherence percentage (Epic 17)
  - [ ] Implement compact, card-based layout
- [ ] Create ContextualQuickActionsView component
  - [ ] Implement "Start Today's Routine" action for routine days
  - [ ] Implement "Log Quick Practice" action for non-routine contexts
  - [ ] Add "View Progress" quick action
  - [ ] Design button layout with proper accessibility
- [ ] Redesign DashboardView as Today View
  - [ ] Replace existing content with new component-based structure
  - [ ] Integrate TodayViewViewModel for state management
  - [ ] Maintain existing navigation patterns and sheet presentations
  - [ ] Preserve user greeting and week calendar if beneficial
  - [ ] Update layout hierarchy: Today's Focus (primary), Weekly Progress, Quick Actions, Other
- [ ] Update navigation and routing
  - [ ] Ensure proper navigation to Practice tab from Today's Focus
  - [ ] Maintain existing deep links and navigation destinations
  - [ ] Update quick action routing to appropriate screens
- [ ] Implement loading and error states
  - [ ] Add loading indicators for data-dependent sections
  - [ ] Handle cases where routine data is unavailable
  - [ ] Provide fallback content for offline scenarios

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests. Follow general testing approach in `docs/testing-strategy.md`.

- **Unit Tests:** 
  - Test TodayViewViewModel logic for determining focus state based on different routine scenarios
  - Test weekly progress calculations with mock data
  - Verify contextual quick actions are appropriate for different states
  - Test proper integration with existing view models (RoutinesViewModel, ProgressViewModel)

- **Integration Tests:** 
  - Test full dashboard flow from data loading to UI presentation
  - Verify navigation from Today's Focus to Practice tab works correctly
  - Test quick actions navigate to appropriate screens
  - Ensure weekly progress data updates correctly when new sessions are logged

- **Manual/CLI Verification:** 
  - Launch app and verify Today View displays appropriate content based on routine status
  - Test different scenarios: active routine day, rest day, no routine, completed routine day
  - Verify Weekly Progress Snapshot shows current week data accurately
  - Test quick actions navigate correctly and perform expected functions
  - Confirm layout works properly across different device sizes
  - Verify accessibility features work with VoiceOver

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** Claude Sonnet 4 (claude-sonnet-4-20250514)
- **Completion Notes:** 
  - Successfully implemented complete "Today View" dashboard redesign with component-based architecture
  - Created TodayViewViewModel with comprehensive state management for different focus states (routine day, quick practice, rest day, completed, no routine)
  - Implemented TodaysFocusView as hero component with dynamic content, proper visual hierarchy, and contextual action buttons
  - Built WeeklyProgressSnapshotView with real-time streak, weekly minutes, and visual progress bar representing daily activity
  - Created ContextualQuickActionsView with smart action routing based on user context and routine status
  - Completely redesigned DashboardView following modular component pattern for maintainability
  - Implemented NotificationCenter-based navigation from Dashboard to Practice tab while maintaining fallback functionality
  - Added proper loading states, error handling, and refresh functionality throughout
  - All components use established AppTheme colors and design patterns for consistency
  - Maintained accessibility support with proper labels and VoiceOver compatibility
  - Used placeholder routine adherence percentage (85%) as specified for Epic 17 implementation
- **Change Log:** 
  - Initial Draft - 2025-05-29
  - Implementation Completed - 2025-05-29