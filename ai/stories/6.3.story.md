# Story 6.3: AI Coach Disclaimer Presentation

**Status:** Draft

## Goal & Context

**User Story:** As a User, I want to be clearly informed about the AI Growth Coach's capabilities and limitations (i.e., it's not a human, not medical advice) before or during my first interaction.

**Context:**
This story is the third step in Epic 6, focused on enhancing the AI Coach feature with appropriate disclaimers. It builds upon Story 6.1 (basic chat UI) and Story 6.2 (backend integration), adding necessary disclaimers about AI limitations. This is essential for ethical AI usage, setting appropriate user expectations, and reducing potential liability concerns.

## Detailed Requirements

- Before the user can send their first message to the AI Coach, or prominently displayed at the top of the chat interface, show a clear disclaimer.
- Disclaimer content (to be finalized, example): "Growth Coach is an AI assistant trained on app content. It can help answer questions about Growth Methods and app navigation. It cannot provide medical advice. For medical concerns, please consult a healthcare professional." 
- This disclaimer should be easily accessible even after the first interaction (e.g., via an info icon).
- Ensure the disclaimer is presented in a way that's noticeable but not intrusive to the overall user experience.
- Store a flag in UserDefaults to track whether the user has seen the disclaimer.
- Follow the app's styling guidelines for alerts, notifications, and important messages.
- Ensure accessibility compliance for the disclaimer presentation.

## Acceptance Criteria (ACs)

- AC1: AI Coach disclaimer is displayed to the user before they can type their first message or is persistently visible.
- AC2: Disclaimer content is clear and meets the specified requirements.
- AC3: The mechanism for displaying the disclaimer does not obstruct normal use after acknowledgment if applicable.
- AC4: Disclaimer remains accessible via an info button or similar control after initial presentation.
- AC5: Disclaimer presentation is tracked (user doesn't see full screen disclaimer on every app launch).
- AC6: Disclaimer is fully accessible with VoiceOver and meets other accessibility requirements.

## Technical Implementation Context

**Guidance:**
Developer agent is expected to follow project standards in `docs/coding-standards.md` and understand the project structure in `docs/templates/project-structure.md`. Only story-specific details are included below.

- **Relevant Files:**
  - Files to Create:
    - `Growth/Features/AICoach/Views/DisclaimerView.swift` (disclaimer component)
  - Files to Modify:
    - `Growth/Features/AICoach/Views/CoachChatView.swift` (to integrate disclaimer)
    - `Growth/Features/AICoach/ViewModels/CoachChatViewModel.swift` (to track disclaimer state)

- **Key Technologies:**
  - SwiftUI (for UI components)
  - UserDefaults (for tracking disclaimer presentation)
  - MVVM pattern for state management
  - Accessibility modifiers for VoiceOver compatibility

- **UI/UX Notes:**
  - Use either:
    - A modal sheet that shows on first launch of the Coach feature, with a "Got it" button
    - A persistent banner at the top of the chat that can be collapsed to an info icon
  - Use appropriate warning/information styling from the app's design system
  - Typography should follow app standards, with disclaimer text having sufficient contrast
  - Consider using an icon (e.g., information icon) to make the purpose immediately apparent
  - If using a modal approach, ensure it doesn't appear on every app launch (track in UserDefaults)

- **Data Structures:**
  - Add to `CoachChatViewModel`:
    - `hasSeenDisclaimer: Bool` (backed by UserDefaults)
    - `showingDisclaimer: Bool` (for UI state)
    - `func markDisclaimerAsSeen()`
    - `func showDisclaimerDetails()` (to show disclaimer again when info icon is tapped)

- **Coding Standards Notes:**
  - Follow standards in `docs/coding-standards.md`
  - Use theming and typography from `docs/style-guide.md`
  - Ensure proper state management for disclaimer visibility
  - Add appropriate comments for UserDefaults keys and accessibility modifiers

## Tasks / Subtasks

- [ ] Create `DisclaimerView.swift` with appropriate styling and content
- [ ] Modify `CoachChatViewModel` to track disclaimer presentation state
  - [ ] Add UserDefaults tracking for whether disclaimer has been seen
  - [ ] Add method to mark disclaimer as seen
  - [ ] Add method to show disclaimer details on demand
- [ ] Update `CoachChatView.swift` to:
  - [ ] Present disclaimer initially if not seen before
  - [ ] Add info icon or similar control to access disclaimer after initial view
  - [ ] Ensure chat functionality remains accessible after disclaimer acknowledgment
- [ ] Apply style guide colors, typography, and spacing to disclaimer content
- [ ] Test disclaimer presentation on first launch and subsequent launches
- [ ] Ensure accessibility compliance for all new UI elements
  - [ ] Add proper accessibility labels
  - [ ] Test with VoiceOver
  - [ ] Ensure sufficient color contrast

## Testing Requirements

**Guidance:**
Verify implementation against the ACs using the following tests. Follow general testing approach in `docs/testing-strategy.md`.

- **Unit Tests:**
  - Test that `hasSeenDisclaimer` correctly reads from and writes to UserDefaults.
  - Test that `markDisclaimerAsSeen()` properly updates UserDefaults.
  - Test that `showDisclaimerDetails()` correctly updates the UI state.

- **Integration Tests:**
  - Test that disclaimer appears on first launch of AI Coach feature.
  - Test that disclaimer doesn't appear on subsequent launches after being acknowledged.
  - Test that info icon (or similar) correctly shows disclaimer when tapped.

- **Manual/Exploratory Testing:**
  - Launch app for the first time, navigate to Coach tab, verify disclaimer appears.
  - Acknowledge disclaimer, leave Coach tab, return to verify it doesn't reappear.
  - Tap info icon (or similar) to verify disclaimer can be viewed again.
  - Test with VoiceOver enabled for accessibility.
  - Test on both light and dark mode.
  - Test on different device sizes (iPhone SE, iPhone 15 Pro Max, iPad if supported).

- **Accessibility Testing:**
  - Use VoiceOver to verify all disclaimer elements are labeled correctly.
  - Check color contrast for disclaimer text and background.
  - Ensure all interactive elements meet 44pt minimum touch target.

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** `<Agent Model Name/Version>`
- **Completion Notes:** {Any notes about implementation choices, difficulties, or follow-up needed}
- **Change Log:**
  - Initial Draft 