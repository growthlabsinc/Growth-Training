# Story 16.3: Create Engaging "Rest Day" Experience

**Status:** Review

## Goal & Context

**User Story:** As a User on a scheduled rest day, I want a meaningful and engaging experience in the app, rather than a confusing empty timer or lack of guidance.

**Context:** This story builds upon the routine infrastructure established in Stories 16.1 and 16.2 by creating a dedicated rest day experience. The app already has DaySchedule models with `isRestDay` boolean flags, rest day UI components (`RestDayBadge`, `RestDayContent`), and comprehensive session logging infrastructure via `SessionLog` model. This story focuses on transforming rest days from passive experiences into engaging wellness interactions that complement the active training days while maintaining the app's supportive and professional tone.

## Detailed Requirements

- Design and implement a dedicated interface for "Rest Days" within a routine. This should replace the standard timer interface.
- Provide valuable content for rest days, such as:
  - Recovery tips.
  - Light stretching suggestions or short guided meditations.
  - Links to relevant "Learn" section articles.
- Allow users to log wellness activities on rest days (e.g., "Logged 10 mins stretching," "Read recovery article").
- Track rest day engagement differently than practice day session logging.
- Ensure the "Today's Focus" on the Dashboard clearly indicates it's a rest day and links to this dedicated experience.

## Acceptance Criteria (ACs)

- AC1: A dedicated UI is presented for rest days, distinct from practice day interfaces.
- AC2: Rest day interface provides recovery tips and/or suggestions for light activities.
- AC3: Users can log simple wellness activities on rest days.
- AC4: Rest day engagement metrics are tracked separately.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. Developer agent is expected to follow project standards in `docs/coding-standards.md` and understand the project structure in `docs/project-structure.md`. Only story-specific details are included below.

- **Relevant Files:**

  - Files to Create: 
    - `Growth/Features/Routines/Views/RestDayExperienceView.swift` (main rest day interface)
    - `Growth/Features/Routines/ViewModels/RestDayViewModel.swift` (rest day logic)
    - `Growth/Features/Routines/Views/Components/WellnessActivityLogView.swift` (wellness logging component)
    - `Growth/Core/Models/WellnessActivity.swift` (wellness activity types and data model)

  - Files to Modify: 
    - `Growth/Features/Routines/Views/DailyRoutineView.swift` (integrate rest day experience)
    - `Growth/Features/Dashboard/Views/DashboardView.swift` (update Today's Focus for rest days)
    - `Growth/Core/Services/JournalingPromptService.swift` (add wellness-focused prompts)
    - `Growth/Features/SessionLogging/ViewModels/LogSessionViewModel.swift` (extend for wellness logging)

- **Key Technologies:**
  - SwiftUI for UI implementation
  - Firebase Firestore for data persistence (leveraging existing SessionLog infrastructure)
  - Existing session logging and journaling infrastructure

- **UI/UX Notes:**
  - Maintain pale green (`PaleGreen`) color scheme for rest day consistency
  - Use leaf iconography and rest day hero images (`day4_rest_hero`, `hero_today`)
  - Create calming, supportive interface distinct from active training days
  - Follow existing design patterns from `LogSessionView` for wellness activity logging

- **Data Structures:**
  - Leverage existing `SessionLog` model for wellness activity tracking
  - Extend `JournalingPrompt` with wellness/recovery categories
  - Create `WellnessActivity` enum for activity types (stretching, meditation, reading, sleep tracking, etc.)
  - Use existing `DaySchedule.isRestDay` property for rest day detection

- **Environment Variables:**
  - None specific to this story - uses existing Firebase configuration

- **Coding Standards Notes:**
  - Follow existing ViewModel patterns from `LogSessionViewModel`
  - Use existing navigation patterns from `DailyRoutineView`
  - Maintain accessibility standards with proper labels and VoiceOver support
  - Follow existing color and typography conventions from `AppTheme`

## Tasks / Subtasks

- [x] Create WellnessActivity model and enum for activity types
- [x] Develop RestDayViewModel with wellness activity management
- [x] Implement RestDayExperienceView with recovery content and activity suggestions
- [x] Create WellnessActivityLogView component for logging wellness activities
- [x] Extend JournalingPromptService with wellness/recovery prompts
- [x] Modify DailyRoutineView to show RestDayExperienceView for rest days
- [x] Update DashboardView "Today's Focus" to highlight rest day experience
- [x] Extend LogSessionViewModel to handle wellness activity logging
- [x] Add rest day assets and content (recovery tips, stretching suggestions)
- [x] Implement rest day engagement metrics tracking
- [x] Test rest day flow from Dashboard through completion
- [x] Ensure proper navigation and state management

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests. Follow general testing approach in `docs/testing-strategy.md`.

- **Unit Tests:**
  - `RestDayViewModelTests`: Test wellness activity creation, validation, and saving
  - `WellnessActivityTests`: Test model validation and data conversion
  - `JournalingPromptServiceTests`: Test wellness prompt retrieval

- **Integration Tests:**
  - Test complete rest day flow from Dashboard detection to activity logging
  - Test SessionLog integration with wellness activities
  - Test navigation between rest day experience and other app sections

- **Manual/CLI Verification:**
  - Verify rest day UI appears correctly when `DaySchedule.isRestDay = true`
  - Test wellness activity logging saves to Firestore correctly
  - Confirm Dashboard "Today's Focus" shows rest day content appropriately
  - Validate accessibility compliance with VoiceOver navigation

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** `Claude Sonnet 4 (claude-sonnet-4-20250514)`
- **Completion Notes:** 
  - Successfully implemented comprehensive rest day experience with wellness activity logging
  - Created WellnessActivity model with 10 different activity types and suggestions
  - Extended JournalingPromptService with wellness and recovery categories
  - Built RestDayViewModel with real-time wellness activity tracking and engagement metrics
  - Implemented RestDayExperienceView with recovery tips, activity suggestions, and journaling prompts
  - Created WellnessActivityLogView component for logging wellness activities with duration and notes
  - Extended LogSessionViewModel to handle wellness activities (stored as SessionLog with wellness_ variation prefix)
  - Updated DailyRoutineView to show dedicated rest day experience for isRestDay = true
  - Enhanced Dashboard "Today's Focus" to highlight rest day wellness exploration
  - All wellness activities are tracked separately using the existing SessionLog infrastructure
  - Rest day engagement metrics include activity count, total time, and activity summaries
  - Successfully compiled and builds without errors
- **Change Log:**
  - Initial Draft
  - Implementation Complete - All ACs satisfied